<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="AuthGuard Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="AuthGuard Documentation Blog Atom Feed"><title data-react-helmet="true">Tutorial 2: Federation with LDAP | AuthGuard Documentation</title><meta data-react-helmet="true" property="og:title" content="Tutorial 2: Federation with LDAP | AuthGuard Documentation"><meta data-react-helmet="true" name="description" content="An example on how to use AuthGuard to authenticate users using an LDAP server"><meta data-react-helmet="true" property="og:description" content="An example on how to use AuthGuard to authenticate users using an LDAP server"><meta data-react-helmet="true" property="og:url" content="https://authguard.github.io/blog/tutorial-ldap"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://authguard.github.io/blog/tutorial-ldap"><link data-react-helmet="true" rel="alternate" href="https://authguard.github.io/blog/tutorial-ldap" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://authguard.github.io/blog/tutorial-ldap" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.73b2fc11.css">
<link rel="preload" href="/assets/js/runtime~main.42d2f7e2.js" as="script">
<link rel="preload" href="/assets/js/main.48e4cf38.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/reduced_authguard_logo.png" alt="AuthGuard" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/reduced_authguard_logo.png" alt="AuthGuard" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AuthGuard</strong></a><a class="navbar__item navbar__link" href="/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/api">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/authguard/AuthGuard" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/reduced_authguard_logo.png" alt="AuthGuard" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/reduced_authguard_logo.png" alt="AuthGuard" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">AuthGuard</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/api">API</a></li><li class="menu__list-item"><a href="https://github.com/authguard/AuthGuard" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">Recent posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/tutorial-email-sms">Tutorial 4: Sending emails and text messages</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/tutorial-oidc">Tutorial 3: Social login with OpenID Connect</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/tutorial-ldap">Tutorial 2: Federation with LDAP</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/tutorial-basic-example">Tutorial 1: Basic example</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="margin-bottom--sm blogPostTitle_GeHD">Tutorial 2: Federation with LDAP</h1><div class="margin-vert--md"><time datetime="2021-11-10T00:00:00.000Z" class="blogPostDate_fNvV">November 10, 2021 Â· 2 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><div class="markdown"><p>If you are in an enterprise environment, chances are that you
already have some sort of an LDAP server, or are planning to
use one. Since the LDAP server will hold the identities of the
internal users, you can make AuthGuard use it instead of requiring
users to sign up.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><ol><li><p>Make sure that you have already followed the instruction on
how to build an AuthGuard distribution. LDAP module is not
currently included in standard distributions.</p></li><li><p>Follow the guideline for the <a href="/docs/setup">server setup</a>.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="scenario"></a>Scenario<a class="hash-link" href="#scenario" title="Direct link to heading">#</a></h2><p>Our scenario is pretty straightforward:</p><ol><li>Users are already added to an LDAP server</li><li>A user can go to your website and application and log
in using their LDAP credentials</li><li>AuthGuard will authenticate the users against the LDAP
server and then whatever token it is configured to generate
just like a normal authentication step</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-setup"></a>Test Setup<a class="hash-link" href="#test-setup" title="Direct link to heading">#</a></h2><p>For the purpose of this tutorial, we will run a test LDAP server
as a container. The image we are going to use is <code>bitnami/openldap:2</code>
since it makes it easier to bootstrap accounts.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3.3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">ldap_server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;bitnami/openldap:2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1389:1389&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1636:1636&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">LDAP_ADMIN_USERNAME</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">LDAP_ADMIN_PASSWORD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> password</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">LDAP_USERS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> user01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">user02</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">LDAP_PASSWORDS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> password1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">password2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>By default, the admin will available using <code>CN=admin,DC=example,DC=org</code>,
and users will be under <code>dc=example,dc=org</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="authguard-configuration"></a>AuthGuard Configuration<a class="hash-link" href="#authguard-configuration" title="Direct link to heading">#</a></h2><p>The configuration is the same as any regular AuthGuard distribution
but with the LDAP section added, and the new exchanges allowed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">ldap</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">adminBindFormat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CN=%s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">DC=example</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">DC=org</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">baseDN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> dc=example</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">dc=org</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">searchAttribute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> uid</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">passwordAttribute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> userPassword</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> localhost</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1389</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">isSecure</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">admin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">adminPassword</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> password</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">bindType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> simple</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">exchange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">providers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accessToken&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sessionToken&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">allowed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">from</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ldap&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accessToken&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">from</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;basic&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">to</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accessToken&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="login"></a>Login<a class="hash-link" href="#login" title="Direct link to heading">#</a></h3><p>The <code>/auth/authenticate</code> endpoint cannot be used in this case,
so a call to <code>/auth/exchange?from=ldap&amp;to=accessToken</code> is
necessary. You can replace <code>accessToken</code> with any of the supported
token types.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;identifier&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user01&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;password&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/tutorial">tutorial</a></div></footer></article><div><a href="https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2021-11-10-ldap-example.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/tutorial-oidc"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« Tutorial 3: Social login with OpenID Connect</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/tutorial-basic-example"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Tutorial 1: Basic example Â»</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#scenario" class="table-of-contents__link">Scenario</a></li><li><a href="#test-setup" class="table-of-contents__link">Test Setup</a></li><li><a href="#authguard-configuration" class="table-of-contents__link">AuthGuard Configuration</a><ul><li><a href="#login" class="table-of-contents__link">Login</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://nexblocks.com/nexblocks" target="_blank" rel="noopener noreferrer" class="footer__link-item">nex::blocks</a></li><li class="footer__item"><a href="https://nexblocks.com/nexblocks/portal" target="_blank" rel="noopener noreferrer" class="footer__link-item">Licenses</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 nex::blocks. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.42d2f7e2.js"></script>
<script src="/assets/js/main.48e4cf38.js"></script>
</body>
</html>